<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>iBandbyte — Artists</title>
  <style>
    :root{
      --brand-yellow:#FFB100;
      --stage-bg:#0e0e0f;
      --card-grad-a:#6a11cb;   /* purple */
      --card-grad-b:#ff6600;   /* orange */
      --ink:#ffffff;           /* default text on dark */
      --muted:#b8b8c2;
      --chip:#1d1d20;
      --chip-border:#2a2a2f;
      --accent:#2a2a2f;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:#0b0b0c radial-gradient(1200px 1200px at 10% -10%, #151518 0%, transparent 40%) fixed;
      color:var(--ink);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      line-height:1.45;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:22px 16px 80px;
    }

    /* Header */
    .header{
      display:flex;align-items:center;gap:14px;max-width:960px;margin:0 auto 18px;
    }
    .logo{display:flex;align-items:center;justify-content:center;width:44px;height:44px;border-radius:12px;background:#1a1a1e;box-shadow:inset 0 0 0 1px #26262b}
    .logo svg{display:block;width:30px;height:30px}
    .brand{font-size:34px;font-weight:800;letter-spacing:.2px}
    .brand .iband{color:#fff}                 /* dark bg → “iBand” white */
    .brand .byte{color:var(--brand-yellow)}   /* “byte” yellow */

    /* Controls */
    .toolbar{max-width:960px;margin:10px auto 18px;display:flex;gap:10px;flex-wrap:wrap}
    .search{
      flex:1 1 320px;padding:12px 14px;border-radius:10px;border:1px solid var(--chip-border);
      background:#17171b;color:#fff;font-size:15px;outline:none;
    }
    .btn{
      padding:12px 18px;border:0;border-radius:10px;color:#fff;font-weight:700;cursor:pointer;
      background:linear-gradient(90deg,var(--card-grad-a),var(--card-grad-b));
      box-shadow:0 6px 20px rgba(0,0,0,.35);
    }
    .btn:hover{filter:brightness(1.05)}

    /* Cards */
    .grid{max-width:960px;margin:0 auto;display:grid;gap:16px}
    .card{
      border-radius:16px;padding:22px 22px 20px;
      background:
        linear-gradient(160deg,rgba(255,255,255,.04),rgba(255,255,255,0)),
        linear-gradient(135deg,var(--card-grad-a),var(--card-grad-b));
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,.06),
        0 10px 24px rgba(0,0,0,.45);
      transition:transform .18s ease, box-shadow .18s ease;
    }
    .card:hover{transform:translateY(-2px);box-shadow:0 16px 36px rgba(0,0,0,.55)}
    .row{display:flex;align-items:center;gap:14px}
    .avatar{
      width:46px;height:46px;border-radius:50%;
      background:radial-gradient(circle at 30% 30%, #ffd7a0 0%, #ff9e72 35%, #e560ff 100%);
      display:grid;place-items:center;font-weight:800;font-size:18px;color:#1a1a1a;box-shadow:inset 0 0 0 2px rgba(255,255,255,.2)
    }
    .title{font-size:22px;font-weight:800;margin:2px 0 6px}
    .meta{color:#f5f5f5;opacity:.9}
    .chipbar{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}
    .chip{
      background:rgba(20,20,24,.35);border:1px solid rgba(255,255,255,.08);color:#fff;
      padding:5px 9px;border-radius:999px;font-size:12px
    }

    /* Pagination */
    .pager{max-width:960px;margin:18px auto 0;display:flex;justify-content:center;align-items:center;gap:10px}
    .pager .btn{padding:10px 14px}
    .page-tag{padding:8px 12px;border-radius:10px;background:#16161a;border:1px solid var(--chip-border);color:#d8d8de;font-weight:700}

    /* Error/empty */
    .panel{max-width:960px;margin:18px auto 0;padding:16px;border-radius:12px;border:1px dashed #3a3a43;background:#151519;color:#eaeaf0}
    pre{white-space:pre-wrap;word-break:break-word;margin:0}
  </style>
</head>
<body>
  <!-- Header with inline SVG guitar orb -->
  <header class="header">
    <div class="logo" aria-hidden="true">
      <!-- inline SVG: purple→orange orb with guitar neck -->
      <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="iBandbyte guitar orb">
        <defs>
          <radialGradient id="orb" cx="30%" cy="30%" r="80%">
            <stop offset="0%"  stop-color="#ff9f50"/>
            <stop offset="40%" stop-color="#ff6a3a"/>
            <stop offset="100%" stop-color="#6a11cb"/>
          </radialGradient>
        </defs>
        <circle cx="32" cy="32" r="28" fill="url(#orb)"/>
        <!-- stylised guitar neck/silhouette -->
        <path d="M31 15c2 0 3 1 3 3v19c0 2-1 3-3 3s-3-1-3-3V18c0-2 1-3 3-3zm-4 6c-1.2 0-2.2-.9-2.3-2.1-.1-1.3.9-2.4 2.2-2.4h8.2c1.3 0 2.3 1.1 2.2 2.4-.1 1.2-1.1 2.1-2.3 2.1H27z"
              fill="#fff" opacity=".95"/>
      </svg>
    </div>
    <div class="brand">
      <span class="iband">iBand</span><span class="byte">byte</span>
    </div>
  </header>

  <!-- Controls -->
  <div class="toolbar">
    <input id="search" class="search" type="text" placeholder="Search artists… (e.g. Drake, pop)"/>
    <button id="refresh" class="btn" type="button">Refresh</button>
  </div>

  <!-- Cards -->
  <main id="grid" class="grid" aria-live="polite"></main>

  <!-- Pagination -->
  <nav class="pager" aria-label="Pagination">
    <button id="prev" class="btn" type="button">Prev</button>
    <span id="pageTag" class="page-tag">Page 1</span>
    <button id="next" class="btn" type="button">Next</button>
  </nav>

  <!-- Debug / errors -->
  <section id="panel" class="panel" hidden>
    <pre id="debug"></pre>
  </section>

  <script>
    // ===== CONFIG =====
    const BACKEND_URL = "https://iband-backend-first-2.onrender.com/artists";
    const PAGE_SIZE = 24; // show 24 cards per page (change to 12/18/etc any time)

    // ===== STATE =====
    let allArtists = [];
    let filtered = [];
    let page = 1;

    // ===== DOM =====
    const grid = document.getElementById("grid");
    const search = document.getElementById("search");
    const refreshBtn = document.getElementById("refresh");
    const prevBtn = document.getElementById("prev");
    const nextBtn = document.getElementById("next");
    const pageTag = document.getElementById("pageTag");
    const panel = document.getElementById("panel");
    const debug = document.getElementById("debug");

    // ===== HELPERS =====
    function showDebug(obj){
      panel.hidden = false;
      debug.textContent = typeof obj === "string" ? obj : JSON.stringify(obj,null,2);
    }
    function hideDebug(){ panel.hidden = true; debug.textContent = ""; }
    function letterBadge(name){ return (name?.trim()?.[0] || "?").toUpperCase(); }

    function render(){
      const start = (page-1)*PAGE_SIZE;
      const slice = filtered.slice(start, start+PAGE_SIZE);

      grid.innerHTML = slice.map(a => `
        <article class="card" role="article" aria-label="${a.name}">
          <div class="row">
            <div class="avatar" aria-hidden="true">${letterBadge(a.name)}</div>
            <div>
              <div class="title">${a.name || "Unknown Artist"}</div>
              <div class="meta">${a.genre || "No genre set"}</div>
              <div class="chipbar">
                <span class="chip">Artist</span>
                <span class="chip">${(a.genre || "No genre set")}</span>
              </div>
            </div>
          </div>
        </article>
      `).join("");

      const totalPages = Math.max(1, Math.ceil(filtered.length / PAGE_SIZE));
      page = Math.min(page, totalPages);
      pageTag.textContent = `Page ${page} / ${totalPages}`;
      prevBtn.disabled = page <= 1;
      nextBtn.disabled = page >= totalPages;
    }

    function applyFilter(){
      const q = search.value.trim().toLowerCase();
      if(!q){
        filtered = [...allArtists];
      }else{
        filtered = allArtists.filter(a => {
          const n = (a.name||"").toLowerCase();
          const g = (a.genre||"").toLowerCase();
          return n.includes(q) || g.includes(q);
        });
      }
      page = 1;
      render();
    }

    async function fetchArtists(){
      hideDebug();
      try{
        const t0 = performance.now();
        const res = await fetch(BACKEND_URL, { headers:{ "Accept":"application/json" }});
        if(!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();

        // Guard against bad data
        const clean = Array.isArray(data)
          ? data.filter(x => x && typeof x === "object" && ("name" in x))
          : [];

        allArtists = clean;
        applyFilter();

        const ms = Math.round(performance.now() - t0);
        showDebug({ ok:true, fetched: clean.length, ms, url: BACKEND_URL, pageSize: PAGE_SIZE });
        setTimeout(hideDebug, 1800); // auto-hide success
      }catch(err){
        showDebug({ ok:false, error: String(err), url: BACKEND_URL });
      }
    }

    // ===== EVENTS =====
    search.addEventListener("input", () => applyFilter());
    refreshBtn.addEventListener("click", () => fetchArtists());
    prevBtn.addEventListener("click", () => { if(page>1){ page--; render(); }});
    nextBtn.addEventListener("click", () => { page++; render(); });

    // ===== BOOT =====
    fetchArtists();
  </script>
</body>
</html>